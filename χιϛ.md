# Accidentally around the HTTPS world in 616 characters

Ah, [JavaScript](https://www.ecma-international.org/ecma-262/6.0/). It tempted me to go [code golfing](https://en.wikipedia.org/wiki/Code_golf).

## The problem statement

I wanted to open [truly](https://www.av8n.com/turbid/paper/turbid.htm#sec-def-random) [random](https://en.wikipedia.org/wiki/Hardware_random_number_generator#Physical_phenomena_with_random_properties) websites in a browser, to discover [new things](https://en.wikipedia.org/wiki/There_are_known_knowns) like tools and communities. But what are 'websites'? Let's ignore the web crawler and law enforcement frontiers of the [dark web](https://en.wikipedia.org/wiki/Dark_web) and just deal with the [HTTP(S) protocol(s)](https://en.wikipedia.org/wiki/World_Wide_Web#Function). It's [mostly ICANN domain names](https://en.wikipedia.org/wiki/Alternative_DNS_root) out there, so I pretended that's enough.

## A solution

Public WHOIS databases require already knowing a website in order to look it up. Reverse IP search has both an opt-in (in the registration process) problem and the mention-dependence (and robots.txt) problem with [indexers](https://www.domcop.com/top-10-million-domains)/[archivers](https://archive.org/). Same with registrar logs. [Zone data](https://dnpedia.com/tlds/daily.php) [isn't exactly open or centralized](https://www.iana.org/domains/root/db), especially with ccTLDs, which are sometimes [creatively misused](https://en.wikipedia.org/wiki/Domain_hack).

Then I found this:

> [https://crt.sh/ discovers certificates by continually monitoring all of the publicly known Certificate Transparency (CT) logs.](https://www.comodo.com/news/press_releases/2015/06/comodo-launches-new-certificate-transparency-search-web-site.html)

Afaict, every past (may still exist) and (almost) current TLS-enabled website (subdomains in some cases) is represented, so why not scrape [easily sampled HTML](https://crt.sh/?id=200000000) with free access to hundreds of millions that possibly care about web standards? Modern browsers can't protect us from [boring, unpopular, unfinished](http://tvtropes.org/pmwiki/pmwiki.php/Main/SturgeonsLaw), or untranslatable sites, but incognito windows are safe, right? Right?

# The code

The [c.js file](https://github.com/0joshuaolson1/deranged-discovery/blob/master/c.js) ([raw permalink](https://raw.githubusercontent.com/0joshuaolson1/deranged-discovery/e2bdfe3eccf131ea128840ac918800e930389414/c.js)) is 616 ASCII bytes including the newline GitHub inserts ([GitLab](https://about.gitlab.com/2016/05/11/git-repository-pricing/) ftw),  as you will when your enter/return key executes it in the Chrome Devtools console (requirement explained later):

```
h='https://';r=(u,c)=>fetch(u).then(r=>r.text()).then(c(u));c=l=>r(h+'qrng.anu.edu.au/API/jsonI.php?z='+Date.now()+'&type=uint8&length='+l,u=>(d,n=5e8,_)=>{for(d=JSON.parse(d).data,e=0,E=1;e<E-E%n?(r(h+'crt.sh/?id='+e%n,u=>(s,$='&nbsp;',_=$+$+$+$,b='<BR>'+_,e=b+_+_+_+'DNS:',i=s.search(b+_+_+'X509v3'+$+'Subject'+$+'Alternative'+$+'Name:'+$+e),j,S=new Set)=>{for(j=i+=s.slice(-1)==`
`||i<0&&open(u)?I:129;i==j;j=s.indexOf(e,i))S.add(h+s.slice(2*(s[i=j+104]=='*')+i,i=s.indexOf(b,i)));S.forEach(s=>fetch(s,{method:'HEAD'}).then(_=>open(s)))}),e=e/n|0,E=E/n|0):E%=n;)for(e%=n;E<n;E*=256)e+=E*(d.length?d.pop():_[E])})
```
CONTINUE WRITING HERE
